# Docker image for pod
image:
  repository: 407733091588.dkr.ecr.us-west-2.amazonaws.com/ego-server/mock-server
  tag: 5.5.1

kind: Deployment

# Replica pod count
replicas: 1

# Labels
labels:
  metricsProm: false

# Update strategy
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0

# Anti/Affinity rules
affinity:
  nodeAffinity:
    key: prod-1-tier
    values: microservice
  podAntiAffinity:
    weight: 100
    key: app
    values: mock-server
    topologyKey: kubernetes.io/hostname

# Container startup command
command: []

# Environment variales for pod
env:
  - name: SERVER_PORT
    value: "8080"
  - name: LOG_LEVEL
    value: "DEBUG"

# Pod resources
resources: []

# livenessProbe configuration
livenessProbe:
  tcpSocket:
    port: 8080
  initialDelaySeconds: 15
  periodSeconds: 7
  successThreshold: 1
  failureThreshold: 10

# livenessProbe configuration
readinessProbe:
  tcpSocket:
    port: 8080
  initialDelaySeconds: 9
  periodSeconds: 3
  successThreshold: 1
  failureThreshold: 10

# Container ports
containerPorts:
  - name: serviceport
    containerPort: 8080
    protocol: TCP

# k8s Service
service:
  # k8s Service type
  type: NodePort
  # k8s Service ports (If you adding new ports make sure that you set them in "containerPorts" too)
  ports:
    - port: 8080
      targetPort: 8080
      name: http-rest

##########################
##########################

# k8s Secret for microservice
secret:
  create: false
  # name: "secret-stuff"
  # version: 1.0.0
  # secretContents: {}

##########################
##########################

# K8s ServiceAccount for pod
serviceAccount:
  create: false
  # name: ""
  # annotations:
  #   eks.amazonaws.com/role-arn: arn:aws:iam::407733091588:role/----